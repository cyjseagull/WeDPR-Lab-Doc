# 2. 跨机构元信息同步

标签: ``数据同步`` ``跨机构`` ``区块链``

----

## 2.1 背景

隐私计算节点部署于各机构，机构之间数据隔离。但为了协调多个机构完成隐私计算任务，机构之间需引入资源同步服务来共享一些资源元数据信息。

*******
## 2.2 功能目标

- 可灵活接入多种资源
- 新接入机构可同步开放访问的所有历史资源元信息
- 支持去中心化的资源同步方式(区块链)

*******
## 2.3 整体架构

![](../../images/design/sync.png)

**全局定序**
- 客户端或其他隐私隐私计算平台(互联互通场景)向站点端发起资源操作请求，如上传、更新、删除数据集等，校验请求，涉及到元数据Create, Remove, Update的操作均封装成ResourceTx，部署到区块链
- 区块链为每个`ResourceTx`分配全局递增的状态index，并将`index, ResourceTx`写入到链上

**状态同步**
- 站点端监听合约事件，并从链上同步最新状态的资源元信息，将其放入到资源池中

**提交ResourceTx**

- 站点端定期从ResourcePool中按序取出ResourceTx，并根据资源类型ResourceType dispatch到不同模块处理，并将处理的ResourceTx对应的index记录到DB中
- ResoureTx执行完毕后，请求对应的站点端通过ResponseCallback，将资源执行结果推送给客户端

涉及到需要同步的资源元信息包括:

- 数据集 && 数据集授权信息
- 审批流
- 服务 && 服务授权信息


