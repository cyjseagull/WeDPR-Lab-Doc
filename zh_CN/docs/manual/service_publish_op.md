# 6. 发布服务

标签: ``服务发布``

----

```eval_rst
.. note::
   - WeDPR隐私计算平台中，所有用户可看到其他用户发布成功的服务元信息，但尽在发起申请并获取授权后才可访问这些服务。
```

WeDPR支持将数据集发布为匿踪查询服务，也支持将模型发布为服务。功能上支持发布服务、服务查询、服务申请的等功能。

<img src="../../manual/service/service_publish_home.png" style="zoom:40%;" />


*******
## 6.1 服务查询

 单击左侧导航栏的【服务发布】进入到服务发布页面，页面展示的服务分为三类：
  - 我的服务: 当前登录用户发布的所有服务
  - 可申请的服务: 当前登录用户没有使用权限的服务列表，须【申请使用】，获取授权后，该用户才可访问服务
  - 已授权的服务: 当前登录用户可以使用的服务列表
 支持的查询条件如下：

  | **查询条件** | **说明**     |
    |:---------|:-----------|
  | 发布机构     | 根据机构查询服务   |
  | 发布用户     | 根据服务属主查询服务 |
 | 服务名称     | 根据服务名称查询服务 |
 | 服务ID     | 根据服务ID查询服务 |
  | 发布状态     | 根据发布状态查询服务 |
  | 发布时间     | 根据发布时间查询服务 |

## 6.2 服务发布

### 6.2.1 发布匿踪查询服务

**使用前提**
****
- 当前用户上传至少一份数据集，用于发布为匿踪查询服务
- 当前用户需参考[凭证管理](./credential_mgr_op.md)，申请凭证用于访问发布的匿踪查询服务

**操作步骤**
****

- 单击左侧导航栏的【服务发布】, 进入到服务发布页面
- 单击右上角【发布匿踪查询服务】,进入到具体发布服务页面，填写如下参数，并选择要发布的数据集

  | **参数名称** | **参数说明**                     |
  |:---------|:-----------------------------|
  | 服务名称    | 必填，发布的服务名称             |
  | 服务简介     | 必填，服务的描述信息      |

- 【设置访问凭证】: 从下拉框中选择可访问该匿踪查询服务的访问凭证
- 【设置查询规则】: 需要设置查询主键、查询类型、查询字段

  <img src="../../manual/service/pir_publish.png" style="zoom:40%;" />

*******
- 以上设置完成后，单击【发布服务】可触发匿踪查询服务发布，通过【服务发布】->【我的服务】页面可查看最新发布的服务状态以及服务的【授权信息】和【使用记录】

   <img src="../../manual/service/pir_detail.png" style="zoom:40%;" />

****

### 6.2.2 发布模型预测服务

**使用前提**
****

- 当前用户存在至少一个模型，模型可通过SecureLGBM和SecureLR训练任务产生，具体可参考[发起SecureLGBM训练任务](wizard_mode_op.html#securelgbm)和[发起SecureLR训练任务](wizard_mode_op.html#securelr)
- 当前用户需参考[凭证管理](./credential_mgr_op.md)，申请凭证用于访问发布的服务

**操作步骤**
****

- 单击左侧导航栏【服务发布】进入到服务发布页面
- 单击右上角的【发布模型预测服务】按钮，进入到发布页面，进行配置，具体配置项包括:

  | **配置名称** | **说明**            |
    |:---------|:------------------|
  | 服务名称     | 必填，发布的服务名称        |
  | 服务简介     | 必填，服务的描述信息        |
  | 选择发布模型   | 必填，从模型列表中选取要发布的模型 |


  <img src="../../manual/service/lgbm_publish.png" style="zoom:40%;" />

*******
- 单击【发布服务】可将模型发布为预测服务，通过【服务发布】->【我的服务】页面可查看最新发布的服务状态以及服务的【授权信息】和【使用记录】


## 6.3 申请服务使用权限

**使用前提**
****
- 当前用户需参考[凭证管理](./credential_mgr_op.md)，申请凭证用于访问申请使用的服务

**操作步骤**
****

- 单击左侧导航栏【服务发布】，进入到服务发布列表页面 
- 切换到【可申请的】页面，找到需要申请使用权限的服务，单击【申请使用】，跳转到服务【申请使用页面】，填写审批单信息，即可提交服务使用申请，审批单信息包括

  | **配置名称** | **说明**            |
      |:---------|:------------------|
  | 申请标题     | 必填，审批单标题          |
  | 关注人      | 可选，关注人            |
  | 申请背景     | 必填，申请背景           |
  | 访问凭证     | 必填，用于访问该服务的访问凭证ID |
  | 授权时间     | 必填，申请使用时间         |

  <img src="../../manual/service/service_apply.png" style="zoom:40%;" />

  <img src="../../manual/service/service_apply_detail.png" style="zoom:40%;" />

*******
- 服务属主进入【审批中心】审批后，用户即拥有服务的使用权限
- 用户可参考[发起匿踪查询任务](./wizard_mode_op.html#id4)、[发起SecureLGBM预测任务](./wizard_mode_op.html#id7)和[发起SecureLR预测任务](./wizard_mode_op.html#id8)，在向导模式下使用该服务
- 用户可通过[匿踪查询服务SDK](../sdk/pir_sdk/index.html)，使用匿踪查询SDK访问匿踪服务